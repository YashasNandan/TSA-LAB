import pandas as pd
import matplotlib.pyplot as plt
from statsmodels.tsa.arima.model import ARIMA
from sklearn.metrics import mean_absolute_error, mean_squared_error
import numpy as np

url = '/content/AirPassengers.csv'
df = pd.read_csv(url, parse_dates=['Month'], index_col='Month')
data = df['#Passengers']


train_size = int(len(data) * 0.8)
train, test = data[:train_size], data[train_size:]


def calc_metrics(actual, predicted):
    mae = mean_absolute_error(actual, predicted)
    mse = mean_squared_error(actual, predicted)
    rmse = np.sqrt(mse)
    return mae, mse, rmse


arima_model = ARIMA(train, order=(1, 1, 1))

arima_fit = arima_model.fit()
print(f"ARIMA(1,1,1) Summary:\n{arima_fit.summary()}")

arima_pred = arima_fit.forecast(steps=len(test))
print("ARIMA Metrics:", calc_metrics(test, arima_pred))

plt.plot(test.values, label='Actual')
plt.plot(arima_pred.values, label='ARIMA(1,1,1)')
plt.legend()
plt.title('ARIMA Model Forecast')
plt.show()
